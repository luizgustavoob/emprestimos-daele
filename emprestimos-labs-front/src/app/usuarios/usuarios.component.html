<div class="container">
  <div class="mt-2">
    <div class="p-grid pt-2 pb-2">
      <div class="p-col-12">
        <h3 class="font-weight">Usuários</h3>
      </div>
    </div>

    <div class="separador"></div>

    <form [formGroup]="formFiltro" (submit)="findUsuarios()">
      <div class="p-grid pt-2 pb-2">
        <div class="p-col-12">
          <label for="usuario">Usuário (Número RA ou E-mail)</label>
          <p-autoComplete id="usuario" name="usuario" formControlName="usuario"
            [suggestions]="usuariosList" (completeMethod)="loadUsuarios($event)"
            field="nome" [minLength]="3" class="ui-fluid">

            <ng-template let-usuario pTemplate="item">
              <div class="ui-helper-clearfix">{{ usuario.nome }} | {{ usuario.email }} | {{ usuario.nrora }}</div>
            </ng-template>
          </p-autoComplete>
        </div>
      </div>

      <div class="pt-2">
        <button type="submit" class="btn btn-warning mr-2">Pesquisar</button>
        <button type="button" (click)="cadastrarUsuario()" class="btn btn-dark">Novo</button>
      </div>
    </form>
  </div>

  <div class="mt-3 mb-3">
    <p-table #tableUsuarios [value]="usuarios" styleClass="p-2" [lazy]="true"
      [paginator]="true" [rows]="10" [totalRecords]="totalRecords" (onLazyLoad)="loadLazy($event)"
      [lazyLoadOnInit]="false" [responsive]="true">

      <ng-template pTemplate="header">
        <tr>
          <th>Nome</th>
          <th>E-mail</th>
          <th>Número RA</th>
          <th>Situação</th>
          <th>Permissão</th>
          <th class="text-center col-acoes">Atualizar</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-usuario>
        <tr>
          <td>{{ usuario.nome }}</td>
          <td>{{ usuario.email }}</td>
          <td>{{ usuario.nrora }}</td>
          <td>{{ usuario.ativo | ativo}}</td>
          <td>{{ usuario.permissao | permissao }}</td>
          <td class="text-center col-acoes">
            <button pButton type="button" (click)="alterarSituacao(usuario.idUsuario, usuario.ativo)"
              pTooltip="Alterar situação" icon="pi pi-undo" style="width: 32px;">
            </button>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td [attr.colspan]="7">Nenhum usuário para ser exibido.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<p-confirmDialog></p-confirmDialog>
